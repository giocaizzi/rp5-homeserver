# Netdata Configuration
# Minimal setup optimized for low CPU overhead and reduced fan oscillations

[global]
    # hostname
    hostname = rp5-homeserver

    # Update interval - 5s for minimal CPU overhead
    update every = 5
    
    # History retention - 7 days at 5s intervals
    history = 604800
    
    # Memory mode
    memory mode = dbengine
    page cache size = 32
    dbengine multihost disk space = 1024

[web]
    # Web server
    mode = static-threaded
    bind to = *

[plugins]
    # Essential plugins only
    proc = yes
    cgroups = no   # Disabled - requires pid:host unsupported in Swarm. Use cAdvisor instead.
    go.d = yes
    
    # Disable all other plugins
    diskspace = no
    apps = no
    debugfs = no
    python.d = no
    charts.d = no
    node.d = no
    
[plugin:proc]
    # Core system monitoring only
    /proc/stat = yes
    /proc/loadavg = yes
    /proc/meminfo = yes
    /proc/net/dev = yes
    /proc/diskstats = yes
    
    # Disable less critical metrics
    /proc/uptime = no
    /proc/vmstat = no
    /proc/net/netstat = no
    /proc/interrupts = no
    /proc/softirqs = no
    
# [plugin:cgroups]
    # DISABLED: Per-container cgroup metrics require pid:host which Docker Swarm
    # does not support. Without pid:host, Netdata cannot map container PIDs to
    # cgroup paths, so container metrics won't work.
    #
    # Alternative: cAdvisor is deployed in observability stack (services/observability)
    # and provides per-container CPU, memory, network, disk metrics via Prometheus.
    # View in Grafana: Dashboard â†’ Container Metrics
    #
    # If migrating to K8s or running Netdata outside Swarm, re-enable this section.
    #
    # enable by default cgroups matching = yes
    # enable running cgroups = yes
    # enable cgroups = yes
    # enable cgroups cpuacct = yes
    # enable cgroups memory = yes
    # enable cgroups blkio = yes
    # search for cgroups in subpaths matching = !system.slice *
    
[plugin:go.d]
    # Docker metrics only
    docker = yes
    
[health]
    # Health checks enabled
    enabled = yes
    
    # Reduced check frequency
    default repeat warning = 30
    default repeat critical = 30
