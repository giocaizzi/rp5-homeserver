<?xml version="1.0"?>
<clickhouse>
    <!-- Network settings - allow connections from other containers -->
    <listen_host>0.0.0.0</listen_host>

    <!-- Memory limits for ARM64 (Pi 5 with 8GB) -->
    <max_server_memory_usage_to_ram_ratio>0.5</max_server_memory_usage_to_ram_ratio>
    <max_concurrent_queries>10</max_concurrent_queries>

    <!-- Reduce caches (defaults are too large for Pi) -->
    <mark_cache_size>134217728</mark_cache_size>
    <uncompressed_cache_size>67108864</uncompressed_cache_size>

    <!-- Disable verbose logging to reduce I/O -->
    <asynchronous_metric_log remove="1"/>
    <metric_log remove="1"/>
    <query_thread_log remove="1"/>
    <trace_log remove="1"/>
    <text_log remove="1"/>
    <part_log remove="1"/>

    <!-- Compression settings -->
    <compression>
        <case>
            <min_part_size>10000000000</min_part_size>
            <min_part_size_ratio>0.01</min_part_size_ratio>
            <method>lz4</method>
        </case>
    </compression>
</clickhouse>
